syntax="proto3";

//Имя будущего пакета, в котором будут содержаться все интерфейсы, функции, структуры и т.п.
package auth;

//Путь к будущему пакету. Он будет использоваться при импорте пакета Auth в другие пакеты
option go_package = "tuzov.sso.v1;ssov1";

service Auth {
    //Регистрация нового пользователя
    rpc Register (RegisterRequest) returns (RegisterResponse);

    //Получение токена при логировании пользователя
    rpc Login (LoginRequest) returns (LoginResponse);

    //Проверка, является ли пользователь Администратором
    rpc IsAdmin(IsAdminRequest) returns (IsAdminResponse);

    //Добавление пользователю роли
    rpc SetupRole(RoleRequest) returns (RoleResponse);
}

//Сервис для реализации проверки прав пользователей (на будущее)
//service Permissions {
//  rpc GetUserPermissions(GetUserPermissionsRequest) returns (GetUserPermissionsResponse);
//}

//Объект, который отправит функция регистрации 
message RegisterRequest {
    string email = 1;
    string password = 2;
}

//Объект, который функция регистрации вернет
message RegisterResponse {
    int64 user_id = 1;
}

//Объект, который отправит функция Login
message LoginRequest {
    string email = 1;
    string password = 2;
    int32 app_id = 3;
}

//Объект, который вернет функция LoginResponse (токен)
message LoginResponse {
    string token = 1;
}

message IsAdminRequest {
    int64 user_id = 1;
}

message IsAdminResponse {
    bool is_admin = 1;
}

message RoleRequest {
    int64 uid = 1;
    int32 role = 2;
}

message RoleResponse {
    bool success = 1;
}